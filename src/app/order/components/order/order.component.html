<mat-horizontal-stepper [linear]="isLinear" #stepper>
  <mat-step [stepControl]="firstFormGroup">
    <form [formGroup]="firstFormGroup">
      <ng-template matStepLabel><mat-icon>shopping_cart</mat-icon></ng-template>
      <div class="position-button">
        <button class="margin-button" mat-stroked-button color="accent" matStepperNext>
          Continuar
          <mat-icon>
            navigate_next
          </mat-icon>
        </button>
      </div>
      <mat-form-field style="display: none;">
        <input matInput formControlName="firstCtrl">
      </mat-form-field>

        <mat-table [dataSource]="products$" class="mat-elevation-z8" style="border-radius: 20px; background: #ffffff00;">
          <!-- Image -->
          <ng-container class="img-cont" matColumnDef="imagen">
            <mat-header-cell *matHeaderCellDef> Imagen </mat-header-cell>
            <mat-cell *matCellDef="let products"><img style="margin: 10px 0px;" width="40px" [src]="products.imagen"></mat-cell>
          </ng-container>

          <!-- Name -->
          <ng-container matColumnDef="nombre">
            <mat-header-cell *matHeaderCellDef> Nombre </mat-header-cell>
            <mat-cell *matCellDef="let products"> {{ products.nombrearticulo | lowercase }} </mat-cell>
          </ng-container>

          <!-- Quantity -->
          <ng-container matColumnDef="cantidad">
            <mat-header-cell *matHeaderCellDef style="justify-content: center;"> Cantidad </mat-header-cell>
            <mat-cell *matCellDef="let products" style="justify-content: center;"> {{ products.cant }} </mat-cell>
          </ng-container>

          <!-- Total -->
          <ng-container matColumnDef="total">
            <mat-header-cell style="justify-content: flex-end;" *matHeaderCellDef> Total </mat-header-cell>
            <mat-cell style="justify-content: flex-end;" *matCellDef="let products"> {{ products.valorventa * products.cant | currency }} </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
        </mat-table>

    </form>
  </mat-step>
  <mat-step [stepControl]="secondFormGroup">
    <form [formGroup]="secondFormGroup">
      <ng-template matStepLabel><mat-icon>person_pin</mat-icon></ng-template>
      <div class="position-button">
        <button class="margin-button" mat-stroked-button color="accent" matStepperNext>
          Continuar
          <mat-icon>
            navigate_next
          </mat-icon>
        </button>
      </div>
      <!-- <mat-card class="cont-address">
        <mat-card class="shipping-card">
          <mat-card-header style="align-items: center; display: block;">
            <div *ngIf="( addresses$ | async ).length > 0">
              <mat-card-title style="text-align: center;">
                  Numero de contacto
              </mat-card-title>
            </div>
            <div>
              <mat-card-title style="text-align: right;">
                <a mat-button style="padding: 0px 5px;" 
                (click)="openDialog()">
                  Agregar N° celular 
                  <mat-icon style="color:#80ad55;">
                    add_circle
                  </mat-icon>
                </a>
              </mat-card-title>
            </div>
          </mat-card-header>
          <mat-card-content *ngIf="( addresses$ | async ).length === 0">
            Aun no tienes numero de contacto asociado a tu orden. Agrega uno.
          </mat-card-content>
          <mat-card-content *ngIf="( addresses$ | async ).length > 0">
            <div *ngFor="let address of addresses$ | async" class="row">
              <ul>
                <li>Cel: {{'3136187616'}}</li>
              </ul>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-card> -->
      <mat-card class="cont-address">
        <mat-card class="shipping-card">
          <mat-card-header style="align-items: center; display: block;">
            <div *ngIf="( addresses$ | async ).length > 0">
              <mat-card-title style="text-align: center;">
                  Selecciona una dirección
              </mat-card-title>
            </div>
            <div>
              <mat-card-title style="text-align: right;">
                <a mat-button style="padding: 0px 5px;" 
                (click)="openDialog()">
                  Agregar dirección 
                  <mat-icon style="color:#80ad55;">
                    add_circle
                  </mat-icon>
                </a>
              </mat-card-title>
            </div>
          </mat-card-header>
          <mat-card-content *ngIf="( addresses$ | async ).length === 0">
            Aun no tienes direccion para la entrega de tu orden. Agrega una.
          </mat-card-content>
          <mat-card-content *ngIf="( addresses$ | async ).length > 0">
            <div class="row">
              <div class="col">
                <mat-radio-group formControlName="secondCtrl" required>
                  <mat-card *ngFor="let address of addresses$ | async" class="address-shadow">
                    <mat-radio-button (click)="selectAddress(address)" [value]="address">
                        {{ address.direccion | lowercase }}
                    </mat-radio-button>
                  </mat-card>
                </mat-radio-group>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-card>
    </form>
  </mat-step>
  <mat-step>
    <ng-template matStepLabel><mat-icon>assistant_photo</mat-icon></ng-template>
    <div class="position-button">
      <button class="margin-button" 
              mat-stroked-button color="accent" 
              matStepperNext
              (click)="sendOrder()">
        Finalizar
        <mat-icon>
          turned_in_not
        </mat-icon>
      </button>
    </div>
    
    <div class="summary-cont">

      <!-- <mat-card class="contact-cont">
        <mat-card-header>
          <mat-card-title>Información de contacto</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="border">
            <p>Cel: 3136187616</p>
          </div>
        </mat-card-content>
      </mat-card> -->
  
      <mat-card class="address-cont">
        <mat-card-header>
          <mat-card-title>Dirección de entrega</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="border">
            <p>{{ (address$ | async).direccion | lowercase }}<br>{{ (municipality$ | async)?.descripcion }}</p>
          </div>
        </mat-card-content>
      </mat-card>
  
      <mat-card class="order-cont">
        <mat-card-header>
          <mat-card-title>Resumen compra</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="border" *ngFor="let store of ( order$ | async )">
            <p>{{ store.razonsocial }} <br> cantidad de productos añadidos: {{ store.products.length }}</p>
            <p class="aling-right">subTotal: {{ store.total | currency:'$':'symbol':'1.0-0' }}</p>
          </div>
        </mat-card-content>
        <mat-card-footer>
          <mat-card-subtitle class="aling-right p-right-16 font-style">Total: {{ totalPrice$ | async | currency:'$':'symbol':'1.0-0' }}</mat-card-subtitle>
        </mat-card-footer>
      </mat-card>

    </div>

    <div class="position-button">
      <button class="margin-button" 
              mat-stroked-button color="accent" 
              matStepperNext
              (click)="sendOrder()">
        Finalizar
        <mat-icon>
          turned_in_not
        </mat-icon>
      </button>
    </div>

  </mat-step>
</mat-horizontal-stepper>