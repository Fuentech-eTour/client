<div class="store-cont">
    <!-- header -->
    <div class="row between-xs middled-xs header-cont">
        <div class="title-cont">
            <div mat-card-avatar style="background-image: url({{store.imagen}});
            background-size: cover;">
                <img *ngIf="store.imagen ==='' || store.imagen === null || store.imagen === undefined" src="./../../../../assets/images/icon-store.png">
            </div>
            <mat-card-title [routerLink]="['/stores', store.id]">
                {{store.razonsocial | titlecase}}
            </mat-card-title>
        </div>

        <div class="row show-hover nav-cont">
            <div class="row">
                <!-- menu qualification display: none; a espera de implementacion -->
                <a mat-button [matMenuTriggerFor]="aboveMenu" class="btn-style" style="display: none;">
                    <mat-icon style="color: #73726c;">star_border</mat-icon>
                </a>
                <mat-card-subtitle [routerLink]="['/stores', store.id]">
                    ver mas
                </mat-card-subtitle>
            </div>
        </div>
    </div>
    <!-- Swiper --init-->
    <div class="swiper-container general">
        <!-- swiper wrapper -->
        <div class="swiper-wrapper">
            <div *ngFor="let storeProduct of store.products" class="swiper-slide">
                <app-product-store [product]="storeProduct" [razonsocial]="store.razonsocial" [imagen]="store.imagen">
                </app-product-store>
            </div>
        </div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>
    <!-- Swiper --final-->

    <!-- footer display: none; ha espera de implementacion-->
    <div class="row between-xs middled-xs footer-cont">
        <div class="row btn-cont">
            <a mat-button routerLinkActive="active" class="btn-style" *ngIf="!subscribeBtn" (click)="subscribe(store.id)">
                <div class="btn-aling">
                    <span>Suscribirse</span> 
                    <span *ngIf="stateSpinner" matSuffix><mat-spinner diameter=20></mat-spinner></span>
                    <mat-icon *ngIf="!stateSpinner" style="color: #73726c;">notifications_none</mat-icon>
                </div>
            </a>
            <a mat-button routerLinkActive="active" class="btn-style" style="color: black;" *ngIf="subscribeBtn" (click)="subscribe(store.id)">
                <div class="btn-aling">
                    <span>Suscrito</span> 
                    <span *ngIf="stateSpinner" matSuffix><mat-spinner diameter=20></mat-spinner></span>
                    <mat-icon *ngIf="!stateSpinner" style="color: #ff4b88;">notifications_active</mat-icon>
                </div>
                
            </a>
            <a mat-button routerLinkActive="active" class="btn-style btn-style-desktop" (click)="changeShowComment()">
                Comentar<mat-icon style="color: #73726c;">insert_comment</mat-icon>
            </a>
            <a mat-button routerLinkActive="active" class="btn-style btn-style-movil" (click)="openBottomSheet()">
                Comentar<mat-icon style="color: #73726c;">insert_comment</mat-icon>
            </a>
            <!-- <a mat-button routerLinkActive="active" class="btn-style">
                Compartir<mat-icon style="color: #73726c;">reply</mat-icon>
            </a> -->
        </div>
        <div class="row btn-cont">
            <a mat-button routerLink="/stores" routerLinkActive="active" mat-button class="btn-style">
                <mat-icon  style="color: #73726c;">more_horiz</mat-icon>
            </a>
        </div>
    </div>
    <div *ngIf="showComment" class="between-xs middled-xs footer-cont">
        <div style="display: flex; justify-content: center;" *ngIf="stateLoading">
            <mat-spinner diameter=20></mat-spinner>
        </div>
        <div class="comments-cont" *ngIf="!stateComment">
            <p>Aun no hay comentarios, s√© el primero en comentar</p>
        </div>
        <div class="comments-cont">
            <div class="comment" *ngFor="let comment of comments$ | async">
                <div>
                    <div class="avatar">
                        {{ comment.name | slice:0:1 }}
                    </div>
                </div>
                <p>
                    <span><strong>{{ comment.name | titlecase | slice:0:30 | moreContent:29 }}</strong></span>
                    <span class="name-actions">editar</span>
                    <span class="name-actions">eliminar</span><br>
                    {{ comment.comentario | lowercase | slice:0:120 | moreContent:119 }}
                </p>
            </div>
        </div>
        <div class="input-msn-cont">
            <form [formGroup]="form">
                <input  #comment 
                        matInput 
                        formControlName="comentario" 
                        placeholder="Escribenos tus comentarios..." 
                        autocomplete="off">
                <div class="actions-cont">
                    <div class="btn-send-cont">
                        <mat-icon matSuffix (click)="sendComment(comment.value)">send</mat-icon>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- menu qualification -->
<mat-menu #aboveMenu="matMenu" yPosition="above">
    <a mat-button class="btn-style">
        <mat-icon style="color: #73726c;">star_border</mat-icon>
        <mat-icon style="color: #73726c;">star_border</mat-icon>
        <mat-icon style="color: #73726c;">star_border</mat-icon>
        <mat-icon style="color: #73726c;">star_border</mat-icon>
        <mat-icon style="color: #73726c;">star_border</mat-icon>
    </a>
</mat-menu>